---

copyright:
years: 2019, 2020
lastupdated: "2020-02-13"

---

{:new_window: target="blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}
{:child: .link .ulchildlink}
{:childlinks: .ullinks}

# 边缘本机开发最佳实践
{: #edge_native_practices}

您将创建将在边缘运行的工作负载，边缘指的是在 IT 数据中心或云环境的正常范围之外的计算设备。 这意味着您需要考虑这些环境的独特条件。 这被称为边缘本机编程模型。

## 用于开发边缘服务的最佳实践
{: #best_practices}

以下最佳实践和准则帮助您设计和开发边缘服务以与 {{site.data.keyword.edge_notm}} ({{site.data.keyword.ieam}}) 配合使用。
{:shortdesc}

在边缘处自动运行服务与通过以下方式在云中自动运行服务不同：

* 边缘节点的数量可能大很多。
* 边缘节点的网络可能不可靠并且慢很多。 边缘节点通常位于防火墙之后，因此通常无法启动从云到边缘节点的连接。
* 边缘节点受资源限制。
* 缩短等待时间和优化网络带宽是在边缘处运行工作负载的驱动力。 因此，放置工作负载时需考虑数据是关键因素的场景。 
* 通常，边缘节点位于远程位置并且未由操作人员进行设置。 设置边缘节点后，可能没有人员来管理节点。
* 与云服务器相比，边缘节点通常也是可信度更低的环境。

这些差异需要不同的技术以在边缘节点上部署和管理软件。 {{site.data.keyword.ieam}} 专门针对管理边缘节点而设计。 在您创建服务时，遵循以下准则以确保服务旨在用于处理边缘节点。

## 开发服务的准则
{: #service_guidelines}


* **云本机编程模型：**边缘本机编程模型继承了云本机编程的许多原则，包括：

  * 对工作负载进行组件化和容器化 - 对一组微服务构建应用程序，每个微服务打包到逻辑上相关的组中，但平衡该分组以识别不同容器在不同层或边缘节点上最佳运行的位置。
  * 向您的微服务公开 API，使应用程序的其他部分能够查找其依赖的服务。
  * 设计微服务之间的松散耦合，以使它们能够彼此独立地运行，并避免有状态的假设，这些假设会在服务之间实施亲缘关系，如果不实施这些亲缘关系，会破坏弹性缩放、故障转移和恢复。
  * 在 DevOps 框架内实现持续集成和持续部署 (CIE/CD) 以及 Agile Development 实践。
  * 请考虑以下资源以获取有关云本机编程实践的更多信息：
    * [云本机应用程序的 10 个关键属性 ![在新选项卡中打开](../images/icons/launch-glyph.svg "在新选项卡中打开")](https://thenewstack.io/10-key-attributes-of-cloud-native-applications/)
    * [云本机编程 ![在新选项卡中打开](../images/icons/launch-glyph.svg "在新选项卡中打开")](https://researcher.watson.ibm.com/researcher/view_group.php?id=9957)
    *	[了解云本机应用程序 ![在新选项卡中打开](../images/icons/launch-glyph.svg "在新选项卡中打开")](https://www.redhat.com/en/topics/cloud-native-apps)

* **服务可用性：**如果您的服务容器需要和使用其他服务容器，那么您的服务必须容许在某些情况下这些服务不存在。 例如，在容器初始启动时，甚至虽然在从依赖关系图末尾启动然后向上移动时，某些服务可能比其他服务更快启动。 在此情况下，在等待依赖项完全正常运行时，服务容器需要重试。 类似，如果相依服务容器进行自动更新，那么其将重新启动。 最佳实践是让您的服务始终容许其所依赖的服务发生中断。
* **可移植性：**边缘计算跨系统的多个层，包括边缘设备、边缘集群和网络或城域网边缘位置。 您的容器化边缘工作负载的最终放置位置取决于多个因素的组合，包括其对某些资源（例如，传感器数据和传动结构）的依赖性、结束等待时间需求和可用计算容量。 您应该根据将使用应用程序的上下文的需要，将工作负载设计为允许放置在系统的不同层中。
* **容器编排：**对先前提到的有关多层可移植性进行深化；通常，边缘设备将使用本机 Docker 运行时来运行，不进行本地容器编排。边缘集群以及网络和城域网边缘将使用 Kubernetes 配置，以根据共享的竞争性资源需求来编排工作负载。您应该实施容器，以避免对 Docker 或 Kubernetes 的任何显式依赖，从而在分布式边缘计算的不同层实现其可移植性。 
* **外部化配置参数：**使用由 {{site.data.keyword.ieam}} 提供的内置支持来外部化任何配置变量和资源依赖关系，以便可以提供这些内容并将其更新为特定于容器部署到的节点的值。
* **大小注意事项：**服务容器必须尽可能小，从而可在可能很慢的网络或小型边缘设备上进行部署。 为帮助您开发小型服务容器，请使用以下方法：

  * 使用可帮助构建小型服务的编程语言：
    * 最佳：go、rust、c 和 sh
    * 良好：c++、python 和 bash
    * 考虑：nodejs、Java 和基于 JVM 的语言，例如，scala
  * 使用可帮助您构造小型 Docker 映像的方法：
    * 使用 alpine 作为 {{site.data.keyword.linux_notm}} 的基本映像。
    * 要安装基于 alpine 的映像中的程序包，请使用命令 `apk --no-cache --update add` 以避免存储运行时不需要的程序包高速缓存。
    * 删除添加文件的相同 Dockerfile 层（命令）中的文件。 如果使用单独的 Dockerfile 命令行以映像中的文件，那么会增加容器映像的大小。 例如，您可以使用 `&&` 来分组命令以下载、使用并随后删除文件，所有这些都位于单个 Dockerfile `RUN` 命令中。
    * 请勿在运行时 Docker 映像中包含构建工具。 作为最佳实践，使用 [Docker 多阶段构建 ![在新选项卡中打开](../images/icons/launch-glyph.svg "在新选项卡中打开")](https://docs.docker.com/develop/develop-images/multistage-build/) 来构建运行时工件。 然后，有选择地将所需的运行时工件（例如，可执行文件组件）复制到运行时 Docker 映像。
* **保持服务自包含：**因为服务需要通过网络发送到边缘节点并自主启动，服务容器需要包含服务所依赖的一切内容。 您需要将这些资产（例如，所有必需的证书）绑定到容器。 请勿依赖管理员的可用性来完成任务，以向边缘节点添加任何必需的资产从而使服务成功运行。
* **数据隐私：**每当您在网络中移动私有和敏感数据时，就会增加该数据对攻击和暴露的脆弱性。 边缘计算作为其主要优点之一，提供了在创建数据的位置保存数据的机会。 实现保护机制，使用容器时抓住此机会。 最好请不要将该数据传递到其他服务。 如果您必须将数据传递到系统中的其他服务或层，请尝试通过模糊处理或去识别化 (de-identification) 技术，或者使用服务范围内完全拥有的密钥将其加密，从而移除个人身份信息 (PII)、个人健康信息 (PHI) 或个人财务信息 (PFI)。 
* **针对自动化进行设计和配置：**边缘节点以及在节点上运行的服务需要尽可能接近于零操作。 {{site.data.keyword.ieam}} 自动化服务的部署和管理，但是服务必须进行构造以支持 {{site.data.keyword.ieam}} 自动执行这些流程而无需人为干预。 为帮助针对自动化进行设计，请遵循以下准则：
  * 限制服务的用户输入变量数量。 服务定义中任何无缺省值的 UserInput 变量都需要针对每个边缘节点指定值。 尽可能限制变量数量或者避免使用变量的服务。  
  * 如果服务需要多个可配置设置，那么使用配置文件来定义变量。 在服务容器中包含缺省版本的配置文件。 然后，使用 {{site.data.keyword.ieam}} 模型管理系统以使管理员能够提供自己的配置文件并随时间进行更新。
  * **利用标准平台服务：**您的许多应用程序需求通过预先实施的平台服务满足。 与其在应用程序中从头开始创建这些功能，请考虑使用已创建并可供您使用的内容。 此类平台服务的一个来源包括 IBM Cloud Pak，其提供多个功能，其中许多功能本身是使用云本机编程实践构建的，例如：
    * **数据管理：**考虑使用 IBM Cloud Pak for Data 来满足 SQL 和非 SQL、块和对象存储器数据库需求；机器学习和 AI 服务以及数据湖需求。 
    * **安全性：**考虑使用 IBM CloudPak for Security，以满足加密、代码扫描和入侵检测需求。
